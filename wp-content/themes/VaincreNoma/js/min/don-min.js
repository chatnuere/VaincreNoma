function getGiftReference(e,a,t){var n=new Array("Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"),l=new Date,o=n[l.getMonth()],i=l.getFullYear(),r=l.getDate(),s=l.getHours(),p=l.getMinutes();return e+"-"+a+"_"+r+"-"+o+"-"+i+"-"+s+":"+p+"_"+t}function test(e){return!e.match(/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/)}String.prototype.sansAccent=function(){for(var e=[/[\300-\306]/g,/[\340-\346]/g,/[\310-\313]/g,/[\350-\353]/g,/[\314-\317]/g,/[\354-\357]/g,/[\322-\330]/g,/[\362-\370]/g,/[\331-\334]/g,/[\371-\374]/g,/[\321]/g,/[\361]/g,/[\307]/g,/[\347]/g],a=["A","a","E","e","I","i","O","o","U","u","N","n","C","c"],t=this,n=0;n<e.length;n++)t=t.replace(e[n],a[n]);return t};var backupCheck,initDon=function(){initRageSlider();var e=new Date;$(".recurrent input").val(parseInt(e.getDate())),$(".tabHeader label").on("click",function(){var e=$(this).find("input").val();$(".tabHeader label").removeClass("active"),$(".tabContent ul").removeClass("active"),$(".once").removeClass("active"),$(".once").find("input").val(""),$(this).addClass("active"),$("#"+e).addClass("active"),$("#"+e+" li:first-child").find("input").addClass("active"),"REGULAR"==e?$(".recurrent").addClass("active"):$(".recurrent").removeClass("active"),updateValue(parseInt($("#"+e+" li:first-child").find("input").val()))}),$(".tabContent ul li").on("click",function(){$(".tabContent ul li").find("input").removeClass("active"),$(".once").removeClass("active"),$(".once").find("input").val(""),$(this).find("input").addClass("active"),updateValue(parseInt($(this).find("input").val()))}),$("#customNumber").on("input",function(){var e=parseFloat($(this).val().replace(",","."));!isNaN(e)&&e>0&&($(".tabContent ul li").find("input").removeClass("active"),$(".once").addClass("active"),updateValue(e))}),$("#noTip").on("change",function(){console.log(backupCheck),$(this).prop("checked")?(backupCheck=parseFloat($(".theTip").val()),$(".theTip").val("0"),$("#recapTip .value").html("0€"),updateTotalValue(parseFloat($(".valueFisc").val()),parseFloat($(".theTip").val()))):($(".theTip").val(backupCheck),$("#recapTip .value").html(backupCheck+"€"),updateTotalValue(parseFloat($(".valueFisc").val()),parseFloat($(".theTip").val())))}),$(".theTip").on("input",function(){updateTotalValue(parseFloat($(".valueFisc").val()),parseFloat($(this).val().replace(",","."))),$("#recapTip .value").html(parseFloat($(this).val().replace(",","."))+"€")}),$("#who input").on("change",function(){updateFisc($("#who input:checked").val(),parseFloat($(".valueFisc").val()))}),$(".submit a").on("click",function(){checkform()})},updateValue=function(e){$(".valueFisc").val(e),updateFisc($("#who input:checked").val(),e),$("#recapDon .value").html(e+"€"),updateTipFromValue(e),updateTotalValue(e,parseFloat($(".theTip").val()))},updateTotalValue=function(e,a){$("#totalAmount").html(parseFloat(e)+parseFloat(a)+" €")},updateTipFromValue=function(e){if(10>=e)var a=10,t=25,n=20;else if(e>10&&100>=e)var a=5,t=10,n=5;else if(e>100&&1e3>=e)var a=1,t=3,n=2;else if(e>1e3)var a=.5,t=2,n=1.3;$('input[type="range"]').rangeslider("destroy"),$('input[type="range"]').attr("min",e*(a/100)),$('input[type="range"]').attr("max",e*(t/100)),$('input[type="range"]').val(e*(n/100)),initRageSlider()},updateFisc=function(e,a){if("person"==e){var t=a-.66*a;t%1!==0&&(t=t.toFixed(2))}else{var t=a-.6*a;t%1!==0&&(t=t.toFixed(2))}$(".deductionFisc").val(t)},initRageSlider=function(){$("input[type=range]").rangeslider({polyfill:!1,onInit:function(e,a){this.$handle.append("<&nbsp;&nbsp;&nbsp;&nbsp;>"),this.update(),$("#recapTip .value").html(a+"€")},onSlide:function(e,a){$(".theTip").val(a),$("#recapTip .value").html(a+"€"),updateTotalValue(parseFloat($(".valueFisc").val()),a),$("#noTip").attr("checked",!1)}})},checkform=function(){$(".error").removeClass("error"),$("p.error").remove();var e=new Array;if($(".obligatoire").each(function(){0==$(this).val().length&&(e.push($(this)),$(this).addClass("error"),$(this).attr("placeholder","veuillez préciser une valeur s'il vous plait"))}),test($(".email").val())&&($(".emailErrorMsg").remove(),e.push($(".email")),$(".email").addClass("error"),$("<p class='emailErrorMsg'>Veuillez entrer un email valide s'il vous plait</p>").insertAfter($(".email"))),"REGULAR"==$(".active #frequecyInput").val()&&(0==$("#dueDate").val().length&&(e.push($("#dueDate")),$("#dueDate").addClass("error"),$("#dueDate").attr("placeholder","veuillez préciser une valeur s'il vous plait")),(isNaN($("#dueDate").val())||parseInt($("#dueDate").val())>31||parseInt($("#dueDate").val())<1)&&($(".spanError").remove(),e.push($("#dueDate")),$("#dueDate").addClass("error"),$("<span class='spanError'>veuillez entrer un chiffre entre 1 et 31</span>").insertAfter($("#dueDate")))),console.log(e),e.length>0)$("html, body").animate({scrollTop:e[0].offset().top-50},"slow");else{var a="https://api.helloasso.com/donate?oid=28958&reference="+encodeURIComponent(getGiftReference($("#formName").val().sansAccent(),$("#formFisrtName").val().sansAccent(),$(".active #frequecyInput").val()))+"&appId=F7nlG0SJWYCBdIwFnaYaQmmha3VQszSLLWCUtgPZJd9ewfMpNg&email="+encodeURIComponent($(".email").val())+"&title="+encodeURIComponent($("#genre input:checked").val())+"&name="+encodeURIComponent($("#formName").val())+"&firstName="+encodeURIComponent($("#formFisrtName").val())+"&address="+encodeURIComponent($("#formAdress").val())+"&zipCode="+encodeURIComponent($("#formZip").val())+"&city="+encodeURIComponent($("#formCity").val())+"&amount="+encodeURIComponent(100*$(".valueFisc").val())+"&tip="+encodeURIComponent(100*parseInt($(".theTip").val()))+"&frequency="+encodeURIComponent($(".active #frequecyInput").val())+"&urlCallback="+encodeURIComponent("http://vaincre-noma.com/ipn-reponse-api-helloasso/")+"&urlEffectue="+encodeURIComponent("http://vaincre-noma.com/votre-don-a-bien-ete-enregistre/")+"&urlAnnule="+encodeURIComponent("http://vaincre-noma.com/nous-constatons-que-vous-navez-pas-finalise-votre-don/")+"&urlRefuse="+encodeURIComponent("http://vaincre-noma.com/il-semblerait-qu-une-erreur-se-soit-produite/")+"&mode=PREPROD";$("#company").length>0&&(a+="&company="+$("#company").val()),$("#formComment").length>0&&(a+="&comment="+$("#formComment").val()),"REGULAR"==$(".tabHeader input:checked").val()&&(a+="&dueDate="+$("#dueDate").val()),$(window).width()<=800&&(a+="&use=MOBILE"),console.log(a)}};